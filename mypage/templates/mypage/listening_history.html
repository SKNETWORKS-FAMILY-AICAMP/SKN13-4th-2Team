{% extends 'base.html' %}
{% load i18n %}

{% block content %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="mb-0">{% trans "Listening History" %}</h1>
        <form action="{% url 'mypage:clear_listening_history' %}" method="post" onsubmit="return confirm('{% trans "Are you sure you want to clear your listening history? This action cannot be undone." %}');">
            {% csrf_token %}
            <button type="submit" class="btn btn-danger">{% trans "Clear History" %}</button>
        </form>
    </div>

    <ul class="list-group">
        {% for item in history %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong><a href="{{ item.track.track_url }}" target="_blank">{{ item.track.title }}</a></strong> {% trans "by" %} {{ item.track.artist }} <span class="text-muted d-block">{{ item.listened_at|date:"Y-m-d H:i" }}</span>
                </div>
                <a href="{{ item.track.track_url }}" target="_blank" class="btn btn-sm btn-outline-primary">{% trans "Listen Again" %}</a>
            </li>
        {% empty %}
            <li class="list-group-item">{% trans "No listening history yet." %}</li>
        {% endfor %}
    </ul>
    <p class="mt-3">
        <a href="{% url 'mypage:index' %}" class="btn btn-secondary">{% trans "Back to My Page" %}</a>
    </p>
{% endblock %}